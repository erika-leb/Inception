DEFINITION

- serveur demon = programme tournant en arriere plan et gerant les donnees

- Image = packqge contenant du code, des statiaqes, des dependances, le tout inactif

- Conteneur = activation d'une image de facon a faire tourner un processus

- docker-compose = fichier servant a decrire une application  multi-conteneurs dans  un fichier texte puis de la lancer
avantages = -- regrouper plusieurs conteneurs en un projet
-- gerer automatiquement le reseau (cree automatiquement)
-- gerer les volumes
-- definir les dependances (ie ordre de demarrage logique des conteneurs)
-- lancer et arreter toute l'application en une seule commande (docker-compose up et docker-compose down)

COMMANDES (en minuscule, a preceder de 'docker'):
- BUILD = docker build (-t nginx) srcs/requirements/nginx
  -t nginx : sert a donner un nom specifique a l'image creee

- RUN = docker run nginx
  -it : sert a ouvrir le terminal du conteneur a son lancement
  -d : detach, pour que le conteneur tourne en arriere plan
  --name <nom> : nommer le process du conteneur pour qu'il soit plus facile a retrouver

- EXEC = run <container_id (or name)> + commande
  => executer une commande a l'interieur du conteneur
  -it : i -> interactif (garde l'entree standard ouverte)
    t -> tty (simule un terminal)

- BUILD et RUN du fichier .yaml
docker compose up -d --build

- BUIL yaml
docker compose build

- RUN le yaml
docker compose up

- ARRETER le YAML
docker compose stop

- REDEMARRER le YAML
docker compose start

- SUPPRIMER le YAML (build)
docker compose down (supprime conteneur et reseaux)
docker compose down -v  (supprime aussi les volumes)


Fonctionnement de TLS:
la commande openssl req -x509 -nodes -out /etc/nginx/ssl/inception.crt -keyout /etc/nginx/ssl/inception.key -subj "/C=FR/ST=IDF/L=Paris/O=42/OU=42/CN=login.42.fr/UID=login"
permet de demander un certificat SSL (le certficat est stocke dans out et la cle dans keyout)
1) certificat = carte d'identite
role = prouver que le site est celui qu'il pretend etre
ce qu'il contient = nom de domaine (ex: erika.42.fr), nom de l'autorité qui l'a signé, et clé publique
2) cle privee = clef du coffre (secret)
role = dechifrer les donnees que les clients ont envoyees en utilisant la clef publique
securite = Si quelqu'un vole ta clé privée, il peut usurper ton identité et lire les messages cryptés destinés à ton serveur

Pourquoi creer un fichier /var/run/nginx ?
Ce dossier sert à stocker ce qu'on appelle un PID file (Process ID).
-Le concept : Quand Nginx se lance, il écrit son numéro d'identité (le PID) dans un petit fichier à cet endroit précis. 
Cela permet au système de savoir si Nginx est déjà en train de tourner et de pouvoir l'arrêter proprement.
-Le problème Docker : Dans certaines versions de Debian/Alpine (les images de base que tu utilises pour Docker), ce dossier n'existe pas par défaut ou n'a pas les bonnes permissions. 
Si Nginx essaie de se lancer et ne trouve pas ce dossier pour y écrire son PID, il va crash instantanément avec une erreur.
=> il s'agit de modifier les dossiers systeme a l'interieur du conteneur

Filesystem Hierarcy Standard (FHS); dossiers:
-  /usr/local/bin = executables installes par l'utilisateur (localise ici ils sont appelable partout)
- /etc = configuration statique (c'est ici que les logiciels comme php ou nginx cont chercher leurs reglagles au demarrage)
- /var/www = dossier standard de stockage des donnees variables (ie qui changent pendant l'execution) de serveur web 
--/var/lib : données persistantes propres à un service
--/var/www : convetion Lunix pour les fichiers web
- /tmp = dossier destine aux fichiers temporaires (comme les script de config qui servent a configurer des conteneurs au demarrage, avant que le site ne tourne)
- /run = contient les fichiers d'execution, qui sont donnees volatiles sur l'etat du systeme depuis son demarrage
